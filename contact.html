<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact</title>
    <link rel="stylesheet" href="slv.css" />
    <link rel="stylesheet" href="header.css" />
    <link rel="stylesheet" href="footer.css" />
    <link rel="stylesheet" href="contact.css" />

    <script src="header.js" defer></script>
    <script src="footer.js" defer></script>
    <script src="loadFonts.js" defer></script>
  </head>
  <body>
    <div id="header-container"></div>

    <main>
      <section class="contactSection">
        <div class="contactText">
          <h2>Un projet ? Contactez-moi</h2>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit...</p>
          <div class="ctaContainer">
            <a href="index.html" class="cta">Retour vers l'accueil</a>
          </div>
        </div>

        <div class="contactFormContainer">
          <div class="contactForm">
            <form id="contactForm">
              <div class="formGroup">
                <input type="text" id="prenom" name="prenom" placeholder="Prénom" required />
                <input type="text" id="nom" name="nom" placeholder="Nom" required />
              </div>
              <div class="formGroup">
                <input type="email" id="email" name="email" placeholder="Email" required />
              </div>
              <div class="formGroup">
                <textarea id="message" name="message" placeholder="Votre message" required></textarea>
              </div>
              <div class="submit">
                <button type="submit">Envoyer</button>
              </div>
            </form>
            <div id="confirmationMessage" style="display:none; color: green; margin-top: 10px;">
              ✅ Votre message a bien été envoyé !
            </div>
          </div>
        </div>

        <div class="ctaContainer">
          <a href="index.html" class="ctaResponsive">Retour vers l'accueil</a>
        </div>
      </section>
    </main>

    <div id="footer-container"></div>

    <!-- Script de réveil Render -->
    <script>
      const loader = document.createElement("div");
      loader.innerText = "Connexion au serveur...";
      loader.style = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: #222;
        color: #fff;
        padding: 10px;
        text-align: center;
        font-family: sans-serif;
        z-index: 9999;
      `;
      document.body.appendChild(loader);

      fetch("https://slvernez-backend.onrender.com")
        .then(() => {
          console.log("Backend réveillé");
          loader.remove();
        })
        .catch(() => {
          loader.innerText = "Le serveur met du temps à répondre...";
          setTimeout(() => loader.remove(), 5000);
        });
    </script>

    <!-- Script de soumission du formulaire -->
    <script>
      const form = document.getElementById("contactForm");
      const confirmation = document.getElementById("confirmationMessage");

      form.addEventListener("submit", async function (e) {
        e.preventDefault();

        const formData = new FormData(form);

        try {
          const response = await fetch("https://slvernez-backend.onrender.com/send", {
            method: "POST",
            body: formData,
          });

          if (response.ok) {
            confirmation.style.display = "block";
            form.reset();
          } else {
            confirmation.innerText = "❌ Une erreur est survenue. Réessayez plus tard.";
            confirmation.style.color = "red";
            confirmation.style.display = "block";
          }
        } catch (error) {
          confirmation.innerText = "⚠️ Le serveur ne répond pas.";
          confirmation.style.color = "orange";
          confirmation.style.display = "block";
        }
      });
    </script>
  </body>
</html>